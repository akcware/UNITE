<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <title>Sign up as Supplier - UNITE</title>
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="description" content="A cool thing made with Glitch">
  <link id="favicon" rel="icon" href="https://glitch.com/edit/favicon-app.ico" type="image/x-icon">
  <link rel="stylesheet" href="/style.css">
  <link rel="stylesheet" href="/messages.css">
  <link rel="stylesheet" href="/jquery-ui.css">
  <link rel="stylesheet" href="/bootstrap.min.css">
  <script src="/jquery.min.js"></script>
  <script src="/jquery-ui.min.js"></script>
  <script src="/popper.min.js"></script>
  <script src="/bootstrap.min.js"></script>  
  <script src="/index.min.js"></script>
  <script src="/sweetalert2@9.min.js"></script>
  <script src="/money.min.js"></script>
  <script src="/https.js"></script>
  <script src="/chatUsers.js"></script>
  <script src="/autocomp.js"></script>
  <script type="text/javascript">
    $(document).ready(function () {
      var token = $("input[name='_csrf']").val();

      postAutocomplete('.country', '/countryAutocomplete', token);
      getAutocomplete('#industry', '/industryGetAutocomplete', token);
      getAutocomplete('#currency', '/currencyGetAutocomplete', token);
      getCurrenciesList('.currency', '/currencyGetAutocomplete', token);
      errorSuccess(Swal, '<%= errorMessage %>', '<%= successMessage %>');
      initBaseRates(fx, '.currency');
      $('.currency').css('width', '100px');
      var defaultCurr = "EUR";
      
      $('.currency').on('change', function () {
        var val = $(this).val();
        $('input[name="currency"]').val(val);
        $('#currency').val(val);
        //if(val == defaultCurr)
          //return true;
        
        //Re-make the list of products accordingly, with the new currency.
        var prodList = $('#prodServicesList').val(), priceList = $('#pricesList').val(), currList = $('#currenciesList').val();
        if(prodList && prodList.length) {
          var arr = prodList.split(','), arr1 = priceList.split(',');//, arr2 = currList.split(',');
          
          for(var i in arr1) {
            //fx.convert($('#defaultBalance').val(), {from: $('#defaultCurrency').val(), to: $(this).val()});
            var price = fx.convert(arr1[i], {from: defaultCurr, to: val});
            var newDesc = arr[i] + ' - ' + parseFloat(price).toFixed(1) + ' ' + val;
            var li = $('#prodServices').find('li').eq(i);
            var span = li.find('.product');
            span.text(newDesc);
          }
        }
      });

      $('.cb').click(function() {
        $('#register').prop('disabled', $(':checkbox:checked').length == 2? false : true);
      });

      $('#prodServiceInput').on('change', function() {
        $('#addProdService').prop('disabled', $(this).val()? false : true);
      });

       var MAX = parseInt("<%= MAX_PROD %>");
       $("#prodServices").attr('MAX', MAX);
       addProduct($("#addProdService"));
       $('<a><span style="color: green; cursor: pointer" id="massRemove">Remove All Products</span></a><br>').insertBefore($("#prodServices"));
       $('#massRemove').on('click', removeAllProducts);
      
        $('#register').click(function(e) {
          e.preventDefault();

          if(!supplierValidateFields($('#prodServicesList').val(), $('#pricesList').val(), $('#currenciesList').val(), fx, defaultCurr, $('#currency').val()))
            return false;

          registrationDialog('Supplier');
    });
  });
  </script>
</head>

<body>
  <nav user="supplier" class="navbar navbar-expand-lg navbar-dark bg-dark" style="width: 100% !important;">
    <a class="navbar-brand" href="/">UNITE</a>
    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent"
      aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>
  </nav>

  <div class="container">
    <div class="mx-auto text-center mt-4">
      <a href="/">
        <img src="https://cdn.glitch.com/e38447e4-c245-416f-8ea1-35b246c6af5d%2Funite.png?v=1587840844949" height="150">
      </a>
    </div>

    <div class="sign-in-form smooth-shadow">
      <form id="registration" method="POST">
        <h2>Sign up as Supplier</h2>
        <input type="hidden" name="priceList" id="priceList">
        <input type="hidden" name="currencyList" id="currencyList">
        <div class="form-group">
          <label class="text-muted form-text">
            Please fill in all the required (*) fields.
          </label>
        </div>
        <div class="form-group">
          <label>Company Name*</label>
          <input type="text" class="form-control" name="companyName" required>
        </div>
        <div class="form-group">
          <label>Email address*</label>
          <input type="email" class="form-control" name="emailAddress" required>
          <small class="text-muted form-text">Only companies' domains are allowed.</small>
        </div>
        <div class="form-group">
          <label for="password">Password*</label>
          <input type="password" pattern="(?=.*\d)(?=.*[a-z])(?=.*[A-Z]).{6,}" title="Please type at least one number, one uppercase and lowercase letter, and at least 6 characters." class="form-control" id="password" name="password" required>
        </div>
        <div class="form-group">
          <label>Director's name*</label>
          <input type="text" class="form-control" name="directorsName" required>
        </div>
        <div class="form-group">
          <label>Contact Name*</label>
          <input type="text" class="form-control" name="contactName" required>
        </div>
        <div class="form-group">
          <label>Title*</label>
          <input type="text" class="form-control" name="title" required>
        </div>
        <div class="form-group">
            <label>Company Registration No*</label>
            <input type="text" class="form-control" name="companyRegistrationNo" required>
          </div>
        <div class="form-group">
          <label>Registered Country*</label>
          <input type="text" class="form-control country" name="registeredCountry" required>
        </div>
        <div class="form-group">
          <label>Company Address*</label>
          <input type="text" class="form-control" name="companyAddress" required>
        </div>
        <div class="form-group">
          <label>Area Covered</label>
          <input type="text" class="form-control" name="areaCovered">
        </div>
        <div class="form-group">
          <label>Contact Mobile Number*</label>
          <input type="tel" class="form-control" placeholder="+XX XXX XXX XXX" title="Please write the number as +XX XXX XXX XXX" pattern="\+[0-9]{2} [0-9]{3} [0-9]{3} [0-9]{3}" name="contactMobileNumber" required>
        </div>
        <div class="form-group">
          <label>Preferred Currency (Default: Euro)*</label><br>
          <input type="hidden" name="currency" value="<%= profile.currency %>" required>
          <select class="currency" class="form-control" title="Currency" value="<%= profile.currency %>" required><br>
        </div>
        <hr>
        <div class="form-group">
          <label>Country*</label>
          <input type="text" class="form-control country" id="country" name="country" required>
        </div>
        <div class="form-group">
          <label>Industry*</label>
          <input type="text" class="form-control" id="industry" name="industry" required>
        </div>
        <div class="form-group">
          <label>Employee Numbers*</label>
          <input type="number" class="form-control" name="employeeNumbers" required>
        </div>
        <div class="form-group">
          <label>Last Year Turnover*</label>
          <input type="number" class="form-control" name="lastYearTurnover" required>
        </div>
        <div class="form-group">
          <label>Website</label>
          <input type="text" class="form-control" name="website">
        </div>
        <div>
          <p>
            You can use an Excel file with your products list, formatted as product name + product price + product currency (3 cells per row), and after you click on the Process button, our system must automatically add the products and build the list on page.
          </p>
        </div>
        <div class="form-group">
          <label>Please choose your prepared product/service list (*.xls/xlsx, name+price+currency on each row):</label>
          <input class="form-control fileexcelupload" type="file" id="products" name="products" single>
          <input class="form-control single btn btn-dark mt-2" type="button" disabled value="Process Excel File" />
        </div>
        <div class="form-group">
          <label class="col-form-label">Products / Services Offered*</label>
          <br><a href="addproduct">Add new product</a>
          <div class="input-group">
            <input type="text" class="form-control prodInput" placeholder="Product*" title="Add Product/Service" id="prodServiceInput">
            <br>
            <input type="number" min="0.1" step="0.1" placeholder="Price*" class="form-control" title="Price" id="price">
            <select class="form-control" title="Currency" class="currency0" id="currency">
            <div class="input-group-append">
              <button class="btn btn-outline-secondary" type="button" disabled id="addProdService">Add</button>
            </div>
          </div>
          <br>
          <ul class="list-group" id="prodServices">           
          </ul>
          <input type="hidden" required id="prodServicesList" name="productsServicesOffered">
          <input type="hidden" name="pricesList" id="pricesList">
          <input type="hidden" name="currenciesList" id="currenciesList">
        </div>
        <div class="form-group">
          <label>Capability Description*</label>
          <input type="text" class="form-control" name="capabilityDescription" required>
        </div>
        <div class="form-group">
          <label>Relevant Experience*</label>
          <textarea required class="form-control" id="relevantExperience" name="relevantExperience"></textarea>
        </div>
        <div class="form-group">
          <label>Supporting Information</label>
          <input type="text" class="form-control" name="supportingInformation">
        </div>
        
        <div class="form-group">
          <label class="text-muted form-text">
            <!-- You can upload your files to cloud services (e.g. Google Drive) and add the link to the folder here. -->
          </label>
        </div>
        
        <div class="form-group">
          <label>User Avatar</label>
          <input type="hidden" name="avatar">
          <input class="form-control fileupload avatarupload" type="file" id="avatar" name="avatarImg">
          <input class="form-control single btn btn-dark mt-2" type="button" disabled value="Upload File" />
        </div>
        
        <div class="form-group">
          <label>Certificates</label>
          <input type="hidden" class="fileId" name="certificatesIds">
          <input class="form-control fileupload" type="file" id="certificates" name="certificates" multiple>
          <input class="form-control multiple btn btn-dark mt-2" type="button" disabled value="Upload Files" />
        </div>

        <div class="form-group">
          <label>Antibribery policy</label>
          <input type="hidden" class="fileId" name="antibriberyPolicyId">
          <input class="form-control fileupload" type="file" id="antibriberyPolicy" name="antibriberyPolicy"/>
          <input class="form-control single btn btn-dark mt-2" type="button" disabled value="Upload File" />
        </div>

        <div class="form-group">
          <label>Environment policy</label>
          <input type="hidden" class="fileId" name="environmentPolicyId">
          <input class="form-control fileupload" type="file" id="environmentPolicy" name="environmentPolicy"/>
          <input class="form-control single btn btn-dark mt-2" type="button" disabled value="Upload File" />
        </div>

        <div class="form-group">
          <label>Quality management policy</label>
          <input type="hidden" class="fileId" name="qualityManagementPolicyId">
          <input class="form-control fileupload" type="file" id="qualityManagementPolicy" name="qualityManagementPolicy"/>
          <input class="form-control single btn btn-dark mt-2" type="button" disabled value="Upload File" />
        </div>

        <div class="form-group">
          <label>Occupational Safety and Health</label>
          <input type="hidden" class="fileId" name="occupationalSafetyAndHealthPolicyId">
          <input class="form-control fileupload" type="file" id="occupationalSafetyAndHealthPolicy" name="occupationalSafetyAndHealthPolicy"/>
          <input class="form-control single btn btn-dark mt-2" type="button" disabled value="Upload File" />
        </div>

        <div class="form-group">
          <label>Other relevant files</label>
          <input type="hidden" class="fileId" name="otherRelevantFilesIds">
          <input class="form-control fileupload" type="file" id="otherRelevantFiles" name="otherRelevantFiles" multiple>
          <input class="form-control multiple btn btn-dark mt-2" type="button" disabled value="Upload Files" />
        </div>

        <!--Mandatory check of agreements -->
        <div class="form-group">
          <div class="form-check">
            <input class="form-check-input cb" name="UNITETermsAndConditions" id="termscon" type="checkbox" required>
            <a href="../termsConditions">
              <label class="form-check-label cb" for="termscon">
                UNITE Terms And Conditions
              </label>
            </a>
          </div>
        </div>
        
        <div class="form-group">
          <div class="form-check">
            <input class="form-check-input cb" name="antibriberyAgreement" id="antibrib" type="checkbox" required>          
            <a href="../antibriberyAgreement">
              <label class="form-check-label cb" for="antibrib">
                Antibribery Agreement
              </label>
            </a>
          </div>
        </div>

        <input type="hidden" name="_csrf" value="<%= csrfToken %>">
        <button disabled id="register" type="submit" class="btn btn-primary btn-block">Sign Up</button>
        <div class="form-group">
          <label class="text-muted form-text">
            By clicking the "Sign Up" button, you accept <a href="../termsConditions">the UNITE Terms And Conditions</a> and <a href="../antibriberyAgreement">the Antibribery Agreement</a>.
          </label>
        </div>
      </form>
    </div>
    <div id="dialog">
    </div>
  </div>  
</body>

</html>